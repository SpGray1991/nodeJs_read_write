!function(e,t){"object"==typeof exports&&"object"==typeof module?module.exports=t():"function"==typeof define&&define.amd?define("dree",[],t):"object"==typeof exports?exports.dree=t():e.dree=t()}(this,(function(){return(()=>{"use strict";var e={183:function(e,t,r){var n=this&&this.__awaiter||function(e,t,r,n){return new(r||(r=Promise))((function(s,i){function o(e){try{c(n.next(e))}catch(e){i(e)}}function a(e){try{c(n.throw(e))}catch(e){i(e)}}function c(e){var t;e.done?s(e.value):(t=e.value,t instanceof r?t:new r((function(e){e(t)}))).then(o,a)}c((n=n.apply(e,t||[])).next())}))},s=this&&this.__generator||function(e,t){var r,n,s,i,o={label:0,sent:function(){if(1&s[0])throw s[1];return s[1]},trys:[],ops:[]};return i={next:a(0),throw:a(1),return:a(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function a(i){return function(a){return function(i){if(r)throw new TypeError("Generator is already executing.");for(;o;)try{if(r=1,n&&(s=2&i[0]?n.return:i[0]?n.throw||((s=n.return)&&s.call(n),0):n.next)&&!(s=s.call(n,i[1])).done)return s;switch(n=0,s&&(i=[2&i[0],s.value]),i[0]){case 0:case 1:s=i;break;case 4:return o.label++,{value:i[1],done:!1};case 5:o.label++,n=i[1],i=[0];continue;case 7:i=o.ops.pop(),o.trys.pop();continue;default:if(!((s=(s=o.trys).length>0&&s[s.length-1])||6!==i[0]&&2!==i[0])){o=0;continue}if(3===i[0]&&(!s||i[1]>s[0]&&i[1]<s[3])){o.label=i[1];break}if(6===i[0]&&o.label<s[1]){o.label=s[1],s=i;break}if(s&&o.label<s[2]){o.label=s[2],o.ops.push(i);break}s[2]&&o.ops.pop(),o.trys.pop();continue}i=t.call(e,o)}catch(e){i=[6,e],n=0}finally{r=s=0}if(5&i[0])throw i[1];return{value:i[0]?i[1]:void 0,done:!0}}([i,a])}}};Object.defineProperty(t,"__esModule",{value:!0}),t.parseTreeAsync=t.parseTree=t.parseAsync=t.parse=t.scanAsync=t.scan=t.Type=void 0;var i,o=r(17),a=r(113),c=r(147),l=r(837),u=(0,l.promisify)(c.stat),h=(0,l.promisify)(c.readdir),f=(0,l.promisify)(c.readFile),d=(0,l.promisify)(c.lstat);!function(e){e.DIRECTORY="directory",e.FILE="file"}(i=t.Type||(t.Type={}));var p={stat:!1,normalize:!1,symbolicLinks:!0,followLinks:!1,sizeInBytes:!0,size:!0,hash:!0,hashAlgorithm:"md5",hashEncoding:"hex",showHidden:!0,depth:void 0,exclude:void 0,matches:void 0,extensions:void 0,emptyDirectory:!1,excludeEmptyDirectories:!1,descendants:!1,descendantsIgnoreDirectories:!1,sorted:!1,skipErrors:!0},y={symbolicLinks:!0,followLinks:!1,showHidden:!0,depth:void 0,exclude:void 0,extensions:void 0,sorted:!1,skipErrors:!0};function v(e){var t={};if(e){for(var r in p)t[r]=void 0!==e[r]?e[r]:p[r];t.depth<0&&(t.depth=0)}else t=p;return t}function m(e){var t={};if(e){for(var r in y)t[r]=void 0!==e[r]?e[r]:y[r];t.depth<0&&(t.depth=0)}else t=y;return t}function b(e){var t,r=["B","KB","MB","GB","TB"];for(t=0;t<r.length&&e>1e3;t++)e/=1e3;return Math.round(100*e)/100+" "+r[t]}function x(e,t,r,n,s,l){if(void 0!==n.depth&&r>n.depth)return null;if(n.exclude&&e!==t&&(n.exclude instanceof RegExp?[n.exclude]:n.exclude).some((function(e){return e.test(t)})))return null;var u,h,f=e===t?".":(0,o.relative)(e,t),d=(0,o.basename)(t);try{u=(0,c.statSync)(t)}catch(e){if(n.skipErrors)return null;throw e}try{h=(0,c.lstatSync)(t)}catch(e){if(n.skipErrors)return null;throw e}var p,y=h.isSymbolicLink(),v=u.isFile()?i.FILE:i.DIRECTORY;if(!n.showHidden&&"."===d.charAt(0))return null;if(!n.symbolicLinks&&y)return null;if(n.hash){var m=n.hashAlgorithm;(p=(0,a.createHash)(m)).update(d)}var E={name:d,path:n.normalize?t.replace(/\\/g,"/"):t,relativePath:n.normalize?f.replace(/\\/g,"/"):f,type:v,isSymbolicLink:y,stat:n.followLinks?u:h};switch(n.stat||delete E.stat,v){case i.DIRECTORY:var k=[],w=void 0;if(n.followLinks||!y){try{w=(0,c.readdirSync)(t),n.sorted&&(w="boolean"==typeof n.sorted?w.sort():w.sort(n.sorted))}catch(e){if(n.skipErrors)return null;throw e}if(n.emptyDirectory&&(E.isEmpty=!w.length),w.forEach((function(i){var a=x(e,(0,o.resolve)(t,i),r+1,n,s,l);null!==a&&k.push(a)})),n.excludeEmptyDirectories&&!k.length)return null}if(n.matches&&e!==t){var g=n.matches instanceof RegExp?[n.matches]:n.matches;if(!k.length&&g.some((function(e){return!e.test(t)})))return null}if(n.sizeInBytes||n.size){var I=k.reduce((function(e,t){return e+t.sizeInBytes}),0);E.sizeInBytes=I,E.size=n.size?b(I):void 0,n.sizeInBytes||k.forEach((function(e){return e.sizeInBytes=void 0}))}if(n.hash){k.forEach((function(e){p.update(e.hash)}));var L=n.hashEncoding;E.hash=p.digest(L)}n.descendants&&(E.descendants=k.reduce((function(e,t){var r;return e+(t.type===i.DIRECTORY&&n.descendantsIgnoreDirectories?0:1)+(null!==(r=t.descendants)&&void 0!==r?r:0)}),0)),k.length&&(E.children=k);break;case i.FILE:if(E.extension=(0,o.extname)(t).replace(".",""),n.extensions&&-1===n.extensions.indexOf(E.extension))return null;if(n.matches&&e!==t&&(g=n.matches instanceof RegExp?[n.matches]:n.matches).some((function(e){return!e.test(t)})))return null;if((n.sizeInBytes||n.size)&&(I=n.followLinks?u.size:h.size,E.sizeInBytes=I,E.size=n.size?b(I):void 0),n.hash){var z=void 0;try{z=(0,c.readFileSync)(t)}catch(e){if(n.skipErrors)return null;throw e}p.update(z),L=n.hashEncoding,E.hash=p.digest(L)}break;default:return null}return s&&v===i.FILE?s(E,n.followLinks?u:h):l&&v===i.DIRECTORY&&l(E,n.followLinks?u:h),E}function E(e,t,r,c,l,p){return n(this,void 0,void 0,(function(){var y,v,m,x,k,w,g,I,L,z,R,D,B,T,S,O,C,F,Y,A=this;return s(this,(function(P){switch(P.label){case 0:if(void 0!==c.depth&&r>c.depth)return[2,null];if(c.exclude&&e!==t&&(c.exclude instanceof RegExp?[c.exclude]:c.exclude).some((function(e){return e.test(t)})))return[2,null];y=e===t?".":(0,o.relative)(e,t),v=(0,o.basename)(t),P.label=1;case 1:return P.trys.push([1,3,,4]),[4,u(t)];case 2:return m=P.sent(),[3,4];case 3:if(x=P.sent(),c.skipErrors)return[2,null];throw x;case 4:return P.trys.push([4,6,,7]),[4,d(t)];case 5:return k=P.sent(),[3,7];case 6:if(w=P.sent(),c.skipErrors)return[2,null];throw w;case 7:if(g=k.isSymbolicLink(),I=m.isFile()?i.FILE:i.DIRECTORY,!c.showHidden&&"."===v.charAt(0))return[2,null];if(!c.symbolicLinks&&g)return[2,null];switch(c.hash&&(z=c.hashAlgorithm,(L=(0,a.createHash)(z)).update(v)),R={name:v,path:c.normalize?t.replace(/\\/g,"/"):t,relativePath:c.normalize?y.replace(/\\/g,"/"):y,type:I,isSymbolicLink:g,stat:c.followLinks?m:k},c.stat||delete R.stat,I){case i.DIRECTORY:return[3,8];case i.FILE:return[3,15]}return[3,21];case 8:if(D=[],B=void 0,!c.followLinks&&g)return[3,14];P.label=9;case 9:return P.trys.push([9,11,,12]),[4,h(t)];case 10:return B=P.sent(),c.sorted&&(B="boolean"==typeof c.sorted?B.sort():B.sort(c.sorted)),[3,12];case 11:if(T=P.sent(),c.skipErrors)return[2,null];throw T;case 12:return c.emptyDirectory&&(R.isEmpty=!B.length),[4,Promise.all(B.map((function(i){return n(A,void 0,void 0,(function(){return s(this,(function(n){switch(n.label){case 0:return[4,E(e,(0,o.resolve)(t,i),r+1,c,l,p)];case 1:return[2,n.sent()]}}))}))})))];case 13:if(D=(D=P.sent()).filter((function(e){return null!==e})),c.excludeEmptyDirectories&&!D.length)return[2,null];P.label=14;case 14:return c.matches&&e!==t&&(S=c.matches instanceof RegExp?[c.matches]:c.matches,!D.length&&S.some((function(e){return!e.test(t)})))?[2,null]:((c.sizeInBytes||c.size)&&(O=D.reduce((function(e,t){return e+t.sizeInBytes}),0),R.sizeInBytes=O,R.size=c.size?b(O):void 0,c.sizeInBytes||D.forEach((function(e){return e.sizeInBytes=void 0}))),c.hash&&(D.forEach((function(e){L.update(e.hash)})),Y=c.hashEncoding,R.hash=L.digest(Y)),c.descendants&&(R.descendants=D.reduce((function(e,t){var r;return e+(t.type===i.DIRECTORY&&c.descendantsIgnoreDirectories?0:1)+(null!==(r=t.descendants)&&void 0!==r?r:0)}),0)),D.length&&(R.children=D),[3,22]);case 15:if(R.extension=(0,o.extname)(t).replace(".",""),c.extensions&&-1===c.extensions.indexOf(R.extension))return[2,null];if(c.matches&&e!==t&&(S=c.matches instanceof RegExp?[c.matches]:c.matches).some((function(e){return!e.test(t)})))return[2,null];if((c.sizeInBytes||c.size)&&(O=c.followLinks?m.size:k.size,R.sizeInBytes=O,R.size=c.size?b(O):void 0),!c.hash)return[3,20];C=void 0,P.label=16;case 16:return P.trys.push([16,18,,19]),[4,f(t)];case 17:return C=P.sent(),[3,19];case 18:if(F=P.sent(),c.skipErrors)return[2,null];throw F;case 19:L.update(C),Y=c.hashEncoding,R.hash=L.digest(Y),P.label=20;case 20:return[3,22];case 21:return[2,null];case 22:return l&&I===i.FILE?[4,l(R,c.followLinks?m:k)]:[3,24];case 23:return P.sent(),[3,26];case 24:return p&&I===i.DIRECTORY?[4,p(R,c.followLinks?m:k)]:[3,26];case 25:P.sent(),P.label=26;case 26:return[2,R]}}))}))}function k(e,t,r){return!t.symbolicLinks&&e.isSymbolicLink||!t.showHidden&&"."===e.name.charAt(0)||void 0!==t.extensions&&e.type===i.FILE&&-1===t.extensions.indexOf(e.extension)||t.exclude instanceof RegExp&&t.exclude.test(e.path)||Array.isArray(t.exclude)&&t.exclude.some((function(t){return t.test(e.path)}))||void 0!==t.depth&&r>t.depth}function w(e,t,r,n){var s="",a=e.map((function(s,a){var l="";if(void 0!==r.depth&&n>r.depth)return"";if(r.exclude&&(r.exclude instanceof RegExp?[r.exclude]:r.exclude).some((function(e){return e.test(s)})))return"";var u,h,f=(0,o.basename)(s);try{u=(0,c.statSync)(s)}catch(e){if(r.skipErrors)return null;throw e}try{h=(0,c.lstatSync)(s)}catch(e){if(r.skipErrors)return null;throw e}var d=h.isSymbolicLink(),p=u.isFile()?i.FILE:i.DIRECTORY;if(!r.showHidden&&"."===f.charAt(0))return"";if(!r.symbolicLinks&&d)return"";var y=(0,o.extname)(s).replace(".","");if(r.extensions&&p===i.FILE&&-1===r.extensions.indexOf(y))return"";var v=d?">>":p===i.DIRECTORY?"─> ":"── ",m=t+(a===e.length-1?"    ":"│   ");if(l+=v+f,(r.followLinks||!d)&&p===i.DIRECTORY){var b;try{b=(0,c.readdirSync)(s).map((function(e){return(0,o.resolve)(s,e)})),r.sorted&&(b="boolean"==typeof r.sorted?b.sort():b.sort(r.sorted))}catch(e){if(r.skipErrors)return null;throw e}l+=b.length?w(b,m,r,n+1):""}return l}));return a.filter((function(e){return!!e})).forEach((function(e,r,n){s+=t+(r===n.length-1?"└"+e:"├"+e)})),s}function g(e,t,r,a){return n(this,void 0,void 0,(function(){var c,l=this;return s(this,(function(f){switch(f.label){case 0:return c="",[4,Promise.all(e.map((function(c,f){return n(l,void 0,void 0,(function(){var n,l,p,y,v,m,b,x,E,k,w,I,L,z,R;return s(this,(function(s){switch(s.label){case 0:if(n="",void 0!==r.depth&&a>r.depth)return[2,""];if(r.exclude&&(r.exclude instanceof RegExp?[r.exclude]:r.exclude).some((function(e){return e.test(c)})))return[2,""];l=(0,o.basename)(c),s.label=1;case 1:return s.trys.push([1,3,,4]),[4,u(c)];case 2:return p=s.sent(),[3,4];case 3:if(y=s.sent(),r.skipErrors)return[2,null];throw y;case 4:return s.trys.push([4,6,,7]),[4,d(c)];case 5:return v=s.sent(),[3,7];case 6:if(m=s.sent(),r.skipErrors)return[2,null];throw m;case 7:if(b=v.isSymbolicLink(),x=p.isFile()?i.FILE:i.DIRECTORY,!r.showHidden&&"."===l.charAt(0))return[2,""];if(!r.symbolicLinks&&b)return[2,""];if(E=(0,o.extname)(c).replace(".",""),r.extensions&&x===i.FILE&&-1===r.extensions.indexOf(E))return[2,""];if(k=b?">>":x===i.DIRECTORY?"─> ":"── ",w=t+(f===e.length-1?"    ":"│   "),n+=k+l,!r.followLinks&&b||x!==i.DIRECTORY)return[3,15];s.label=8;case 8:return s.trys.push([8,10,,11]),[4,h(c)];case 9:return I=s.sent().map((function(e){return(0,o.resolve)(c,e)})),r.sorted&&(I="boolean"==typeof r.sorted?I.sort():I.sort(r.sorted)),[3,11];case 10:if(L=s.sent(),r.skipErrors)return[2,null];throw L;case 11:return z=n,I.length?[4,g(I,w,r,a+1)]:[3,13];case 12:return R=s.sent(),[3,14];case 13:R="",s.label=14;case 14:n=z+R,s.label=15;case 15:return[2,n]}}))}))})))];case 1:return f.sent().filter((function(e){return!!e})).forEach((function(e,r,n){c+=t+(r===n.length-1?"└"+e:"├"+e)})),[2,c]}}))}))}function I(e,t,r,n){var s="";return r.sorted&&(e=e.sort((function(e,t){return"boolean"==typeof r.sorted?e.relativePath.localeCompare(t.relativePath):r.sorted(e.relativePath,t.relativePath)}))),e.filter((function(e){return!k(e,r,n)})).forEach((function(e,o,a){var c=e.isSymbolicLink?">>":e.type===i.DIRECTORY?"─> ":"── ",l=o===a.length-1?"└"+c:"├"+c,u=t+(o===a.length-1?"    ":"│   ");s+=t+l+e.name,s+=!e.children||!r.followLinks&&e.isSymbolicLink?"":I(e.children,u,r,n+1)})),s}function L(e,t,r,o){return n(this,void 0,void 0,(function(){var n,a,c,l,u,h,f,d,p;return s(this,(function(s){switch(s.label){case 0:n="",r.sorted&&(e=e.sort((function(e,t){return"boolean"==typeof r.sorted?e.relativePath.localeCompare(t.relativePath):r.sorted(e.relativePath,t.relativePath)}))),a=e.filter((function(e){return!k(e,r,o)})),c=0,s.label=1;case 1:return c<a.length?(l=a[c],u=l.isSymbolicLink?">>":l.type===i.DIRECTORY?"─> ":"── ",h=c===a.length-1?"└"+u:"├"+u,f=t+(c===a.length-1?"    ":"│   "),n+=t+h+l.name,d=n,!l.children||!r.followLinks&&l.isSymbolicLink?[3,3]:[4,L(l.children,f,r,o+1)]):[3,6];case 2:return p=s.sent(),[3,4];case 3:p="",s.label=4;case 4:n=d+p,s.label=5;case 5:return c++,[3,1];case 6:return[2,n]}}))}))}t.scan=function(e,t,r,n){var s=(0,o.resolve)(e),i=v(t),a=x(s,s,0,i,r,n);return a&&(a.sizeInBytes=i.sizeInBytes?a.sizeInBytes:void 0),a},t.scanAsync=function(e,t,r,i){return n(this,void 0,void 0,(function(){var n,a,c;return s(this,(function(s){switch(s.label){case 0:return n=(0,o.resolve)(e),a=v(t),[4,E(n,n,0,a,r,i)];case 1:return(c=s.sent())&&(c.sizeInBytes=a.sizeInBytes?c.sizeInBytes:void 0),[2,c]}}))}))},t.parse=function(e,t){var r,n,s="",i=(0,o.resolve)(e),a=m(t);s+=(0,o.basename)(i);try{r=(0,c.statSync)(e)}catch(e){if(a.skipErrors)return null;throw e}try{n=(0,c.lstatSync)(e)}catch(e){if(a.skipErrors)return null;throw e}var l=n.isSymbolicLink();if((a.followLinks||!l)&&r.isDirectory()){var u=void 0;try{u=(0,c.readdirSync)(i).map((function(e){return(0,o.resolve)(i,e)})),a.sorted&&(u="boolean"==typeof a.sorted?u.sort():u.sort(a.sorted))}catch(e){if(a.skipErrors)return null;throw e}s+=u.length?w(u,"\n ",a,1):""}return s},t.parseAsync=function(e,t){return n(this,void 0,void 0,(function(){var r,n,i,a,c,l,f,p,y,v,b,x,E;return s(this,(function(s){switch(s.label){case 0:r="",n=(0,o.resolve)(e),i=m(t),a=(0,o.basename)(n),r+=a,s.label=1;case 1:return s.trys.push([1,3,,4]),[4,u(e)];case 2:return c=s.sent(),[3,4];case 3:if(l=s.sent(),i.skipErrors)return[2,null];throw l;case 4:return s.trys.push([4,6,,7]),[4,d(e)];case 5:return f=s.sent(),[3,7];case 6:if(p=s.sent(),i.skipErrors)return[2,null];throw p;case 7:if(y=f.isSymbolicLink(),!i.followLinks&&y||!c.isDirectory())return[3,15];v=void 0,s.label=8;case 8:return s.trys.push([8,10,,11]),[4,h(n)];case 9:return v=s.sent().map((function(e){return(0,o.resolve)(n,e)})),i.sorted&&(v="boolean"==typeof i.sorted?v.sort():v.sort(i.sorted)),[3,11];case 10:if(b=s.sent(),i.skipErrors)return[2,null];throw b;case 11:return x=r,v.length?[4,g(v,"\n ",i,1)]:[3,13];case 12:return E=s.sent(),[3,14];case 13:E="",s.label=14;case 14:r=x+E,s.label=15;case 15:return[2,r]}}))}))},t.parseTree=function(e,t){var r="",n=m(t);return(r+=e?e.name:"")+(e.children?I(e.children,"\n ",n,1):"")},t.parseTreeAsync=function(e,t){return n(this,void 0,void 0,(function(){var r,n,i,o;return s(this,(function(s){switch(s.label){case 0:return r="",n=m(t),r+=e?e.name:"",i=r,e.children?[4,L(e.children,"\n ",n,1)]:[3,2];case 1:return o=s.sent(),[3,3];case 2:o="",s.label=3;case 3:return[2,r=i+o]}}))}))}},113:e=>{e.exports=require("crypto")},147:e=>{e.exports=require("fs")},17:e=>{e.exports=require("path")},837:e=>{e.exports=require("util")}},t={};return function r(n){var s=t[n];if(void 0!==s)return s.exports;var i=t[n]={exports:{}};return e[n].call(i.exports,i,i.exports,r),i.exports}(183)})()}));